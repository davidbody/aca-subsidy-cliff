---
title: "ACA Subsidies Cliff"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r aca-subsidies, echo=FALSE, message=FALSE, warning=FALSE, error=FALSE, cache=TRUE}
source("aca-subsidies.R")
```

Draft `r format(file.mtime("index.Rmd"), "%B %e, %Y")`

*This draft is a work in progress and will be updated from time to time.*

### Executive Summary

The Affordable Care Act (ACA) contains an insidious feature that can cost (or save) people thousands of dollars based on whether their household income is greater (or less) than a specific amount. People purchasing health insurance through the ACA qualify for premium subsidies if their income is less than 400% of the federal poverty level (FPL). These subsidies can be substantial, even tens of thousands of dollars per year. But if household income exceeds 400% of the FPL, even by a dollar, no subsidy is available, and any subsidies already received must be repaid. This subsidy "cliff" amounts to a an effective marginal income tax rate in excess of 100% and can create a disincentive to work for those affected. This document describes how subsidies and the subsidy "cliff" are calculated and looks at how the size of the cliff varies with age and geographically.

### Main features of the ACA

The [Affordable Care Act (ACA)](https://en.wikipedia.org/wiki/Patient_Protection_and_Affordable_Care_Act) was enacted in 2010 and major provisions went into effect in 2014. The goal, to expand health insurance coverage in the United States, was accomplished in two primary ways.

First, Medicaid eligibility was expanded to all U.S. citizens and legal residents with incomes up to 133% of the federal poverty level. [As of October 2017](https://www.kff.org/uninsured/issue-brief/the-coverage-gap-uninsured-poor-adults-in-states-that-do-not-expand-medicaid/), 32 states (including DC) had expanded Medicaid and 19 had not.

Second, significant changes were made to individual health insurance markets.

* Insurers were required to use community rating, meaning they could no longer deny coverage or charge higher premiums based on pre-existing conditions or sex.
* To avoid adverse selection, almost everyone is required to have health insurance that provides certain essential health benefits. Those who do not have employer-provided insurance or Medicaid are required to buy health insurance or pay a penalty. (This "individual mandate" has been repealed starting in 2019.)
* Finally, subsidies are provided to help people afford such coverage.

The law specifies four tiers of coverage: bronze, silver, gold, and platinum, which are expected to cover 60%, 70%, 80%, or 90%, respectively, of an enrollee's health care costs.

### Two kinds of subsidies

There are two kinds of subsidies under the ACA.

#### Premium tax credits

The larger of the two kinds of subsidies is used to help people pay premiums of policies purchased on health insurance exchanges set up under the ACA. These subsidies are provided in the form of "[premium tax credits](https://www.irs.gov/affordable-care-act/individuals-and-families/the-premium-tax-credit-the-basics-0)" and are available to ACA enrollees earning up to 400% of the federal poverty level (FPL). Premium tax credits are calculated based on an enrollee's expected income and can be paid in advance directly to insurance companies. When enrollees file their income tax returns the following year, premium tax credit is reconciled based on actual income and income tax liability or refund is adjusted accordingly.

#### Cost sharing reductions

[Cost sharing reductions (CSR)](https://en.wikipedia.org/wiki/Cost_sharing_reductions_subsidy) subsidies are provided to reduce the copayments and deductibles for ACA enrollees with incomes under 250% of the FPL. Until 2018, these subsidies were paid to insurance companies to compensate for the costs of reducing copayments and deductibles for eligible ACA enrollees. [Starting in 2018](https://www.nytimes.com/2017/10/12/us/politics/trump-obamacare-executive-order-health-insurance.html), insurance companies will no longer receive the CSR subsidies, but will still be required to reduce copayments and deductibles. Insurance companies therefore raised premiums in order to compensate for the loss of the CSR subsidies.

As we'll see below, these premium increases and the resulting increase in premium tax credits creates perverse effects for certain individuals.

### How is the premium tax credit calculated?

The larger of the two subsidies is the premium tax credit which is available to people whose income is up to 400% of the FPL. This subsidy is designed to make health insurance cost no more than a certain percentage of a household's income. The subsidy is calculated as follows:

* First determine a **reference premium** which is the second lowest silver premium available to the insured.
* Second determine the **applicable percentage** from the table below.
* Third calculate a **maximum available subsidy** as the excess of the reference premium over that percentage of the insured's income.
* Finally, the **actual subsidy** is the lesser of the maximum available subsidy and the premium on the policy selected by the insured.

For 2018, the applicable percentage is determined from the following table, based on household income:

```{r subsidy_table, echo=FALSE, message=FALSE}
library(dplyr)
library(glue)
library(knitr)
label_text <- Vectorize(function(lower_percent, upper_percent) {
  if (lower_percent == 0) {
    return(glue("Less than {100 * upper_percent}%"))
  } else {
    return(glue('At least {100 * lower_percent}% but less than {100 * upper_percent}%'))
  }
})

subsidy_table %>%
  filter(year == 2018) %>%
  mutate(`Household income percentage of FPL` = label_text(lower_percent, upper_percent),
         `Initial percentage` = glue('{format(lower_cap, nsmall=2)}%'),
         `Final percentage` = glue('{format(upper_cap, nsmall=2)}%')) %>%
  select(-year, -lower_percent, -upper_percent, -lower_cap, -upper_cap) %>%
  kable
```

Subsidies are available to people who purchase health insurance on an exchange and whose household income is between 100% and 400% of the FPL. For people in states that have expanded Medicaid under the ACA, subsidies are available for incomes between 138% and 400% of FPL (because almost everyone with an income below 138% of FPL qualifies for Medicaid and therefore is not eligible to buy insurance on an exchange).

The applicable percentages look like this:

```{r apr_charts, echo=FALSE, message=FALSE, fig.height=3, fig.width=10}
library(ggplot2)
library(gridExtra)
grid.arrange(apr_chart("IA") + labs(title = "Medicaid Exapnsion State") + theme(aspect.ratio = 1/3),
             apr_chart("TX") + labs(title = "Non-Medicaid Expansion State") + theme(aspect.ratio = 1/3),
             nrow = 1)
```

(As we'll see later, the discrete jump in applicable percentage at 133% of FPL for non-Medicaid expansion states results in a mini-cliff at that income level.)

The maximum available subsidy will be the excess of the reference premium over the applicable percentage of a household's income.

Note that subsidies are not available to households with incomes below 100% (138% for Medicaid expansion states) or above 400% of the FPL.

### Example

Here is a concrete example of how the premium tax credit is calculated.

```{r example_vars, echo=FALSE}
library(assertthat)
example_fpl <- federal_poverty_level(2018, "IA", 2)
example_income <- 2.75 * example_fpl
example_applicable_percentage <- (8.1 + 9.5)/2
example_reference_premium <- 1165.22
example_maximum_subsidy <- annual_subsidy(example_income, example_fpl, example_reference_premium, "IA")
example_gold_premium <- 1295.92
example_bronze_premium <- 945.24
```

Assume a married couple both age 30 with no children and a household income of $`r format(example_income, big.mark=",")` living in Polk County, Iowa. The 2018 FPL for an Iowa household with 2 people is $`r format(example_fpl, big.mark=",")`. Their income is therefore 275% of the FPL, which means the applicable percentage from the table above will be half-way between 8.10% and 9.50%, or `r example_applicable_percentage`%. The reference premium is the second lowest silver premium available. For this couple  in 2018, only one silver plan is available, so the reference premium is the premium for that plan, which is $`r format(example_reference_premium, big.mark=",", nsmall=2)` per month, or $`r format(example_reference_premium * 12, big.mark=",", nsmall=2)` per year. The maximum available subsidy will be the amount by which the reference premium exceeds `r example_applicable_percentage`% of their income, or $`r format(example_reference_premium * 12, big.mark=",", nsmall=2)` - `r example_applicable_percentage / 100` x $`r format(example_income, big.mark=",")`, which equals $`r format(example_maximum_subsidy, big.mark=",", nsmall=2)`.

Regardless of whether this family purchases a gold policy for $`r format(example_gold_premium * 12, big.mark=",")` per year, or a silver policy for $`r format(example_reference_premium * 12, big.mark=",")` per year, or a bronze policy for $`r format(example_bronze_premium * 12, big.mark=",")` per year, their subsidy will be the full $`r format(example_maximum_subsidy, big.mark=",", nsmall=2)` because this is less than the cost of any of these policies.

### Subsidies rise with premiums

Note that subsidy amounts are driven directly by premiums. Since the available susidy is the excess of the reference premium over a percent of a household's income, the available subsidy rises dollar for dollar with the reference premium, all other things being equal. High premiums therefore translate directly into high subsidies.

### Available subsidy decreases as income rises

As household income rises toward 400% of the FPL, the maximum available subsidy is reduced both by the fact that the applicable percentage applies to a higher income, and by the fact that the applicable percentage gradually rises to 9.56%. This effectively raises the marginal income tax rate for the household, because additional income results in loss of premium tax credits.

It is critical to understand that subsidies are only available to people whose income does not exceed 400% of the FPL. Subsidies are not available when household income exceeds 400% of FPL. **The complete loss of subsidies once household income reaches 400% of FPL creates a "cliff" and implies an effective marginal income tax rate far in excess of 100%.** For a household right at 400% of FPL, a single dollar of additional income will result in a subsidy loss of potentially thousands of dollars. Any subsidies that have already been received will be repaid in the form of an additional liability on the federal income tax return filed the following year.

The following chart shows the maximum available subsidy as a function of household income for the household in the example above.

```{r cliff_chart_age_30, echo=FALSE, message=FALSE}
library(ggplot2)
library(choroplethr)
cliff_chart(19153, "Couple", 30, 0)
```

As shown in the chart, there is a subsidy "cliff" at 400% of FPL, or $`r format(example_fpl * 4, big.mark=",")`. In this example, the size of the cliff is $`r format(round(example_reference_premium * 12 - 0.0956 * 4 * example_fpl), big.mark=",")`. So, for example, if this family receives an advanced premium tax credit based on an estimated income of less than $`r format(example_fpl * 4, big.mark=",")`, but their actual income for 2018 is even one dollar over this amount, they will be liable to repay the entire amount of their subsidy when they file their 2018 federal income tax return in 2019.

In a given year, the size of the cliff is mainly a function of the second highest Silver premium available, which varies by location, household size, and age. Health insurance premiums generally increase with the age of the insureds, so older people tend to face higher subsidy cliffs.

Here are the same charts for 2018 for an individual age 21, and couples age 40, 50, and 60 in Polk County, Iowa.

```{r cliff_chart_age_21, echo=FALSE, message=FALSE}
cliff_chart(19153, "Individual", 21, 0)
```

```{r cliff_chart_age_40, echo=FALSE, message=FALSE}
cliff_chart(19153, "Couple", 40, 0)
```

```{r cliff_chart_age_50, echo=FALSE, message=FALSE}
cliff_chart(19153, "Couple", 50, 0)
```

```{r cliff_chart_age_60, echo=FALSE, message=FALSE}
cliff_chart(19153, "Couple", 60, 0)
```

For comparison, here are the same charts for Douglas County, Nebraska. Nebraska did not expand Medicaid, which accounts for the mini-cliff at 133% of FPL.

```{r cliff_chart_age_21_ne, echo=FALSE, message=FALSE}
cliff_chart(31055, "Individual", 21, 0)
```

```{r cliff_chart_age_30_ne, echo=FALSE, message=FALSE}
cliff_chart(31055, "Couple", 30, 0)
```

```{r cliff_chart_age_40_ne, echo=FALSE, message=FALSE}
cliff_chart(31055, "Couple", 40, 0)
```

```{r cliff_chart_age_50_ne, echo=FALSE, message=FALSE}
cliff_chart(31055, "Couple", 50, 0)
```

```{r cliff_chart_age_60_ne, echo=FALSE, message=FALSE}
cliff_chart(31055, "Couple", 60, 0)
```

The 2018 cliff amount for a couple age 60 in Des Moines (Polk County), IA is $27,225. In Omaha (Douglass County), NE it's a whopping $32,126. As we'll see below, the 2018 cliff amount can go even higher.

### The cliff is high when premiums are high

Why are the cliff amounts so high? The cliff amount is simply the available subsidy at 400% of FPL. High premiums translate directly into high subsidies which translate directly into high cliff amounts.

### Variation in cliff amounts

We've already seen that cliff amounts rise with age because premiums (and therefore subsidies) rise with age.

Since premiums also vary by location, so does the size of the cliff. Let's calculate the size of the "cliff" for similar households in every county in the US. (Only states that use the federal health insurance exchange are included. States that operate their own exchanges are not included.)

```{r cliff_data, echo=FALSE}
c30 <- calc_cliff("Couple", 30, 0)
c40 <- calc_cliff("Couple", 40, 0)
c50 <- calc_cliff("Couple", 50, 0)
c60 <- calc_cliff("Couple", 60, 0)

library(broom)

s30 <- summary(c30$cliff)
s40 <- summary(c40$cliff)
s50 <- summary(c50$cliff)
s60 <- summary(c60$cliff)

t30 <- tidy(s30)
t30$age <- 30
t40 <- tidy(s40)
t40$age <- 40
t50 <- tidy(s50)
t50$age <- 50
t60 <- tidy(s60)
t60$age <- 60

all <- rbind(t30, t40, t50, t60) %>%
  select(Age = age, everything())
```

Here are summary statistics for the 2018 cliff amounts across all counties in the federal health insurance exchange for couples age 30, 40, 50, and 60 with no children.

```{r cliff_summary, echo=FALSE}
kable(all)
```

The following histograms show that distributions for all age examples are skewed, with cliff amounts generally higher for older households.

```{r cliff_histograms, echo=FALSE, fig.height=8}
ggplot(rbind(c30, c40, c50, c60), aes(x = cliff)) +
  geom_histogram(bins = 30) +
  facet_wrap(~ age, ncol = 1, labeller = as_labeller(c(`30` = "Couple age 30, no children",
                                                       `40` = "Couple age 40, no children",
                                                       `50` = "Couple age 50, no children",
                                                       `60` = "Couple age 60, no children"))) +
  labs(title = "Histogram of 2018 ACA Subsidy \"Cliff\"") +
  xlab("ACA Subsidy Cliff") + ylab("Number of counties") +
  theme_minimal()
```

### Geographic variation

The following maps show how the size of the cliff varies geographically. As mentioned earlier, data is only included for states that use the federal health insurance exchange. States that run their own exchanges are coded as NA. The size of the cliff varies with location and shows strong geographical patterns. These patterns appear very similar regardless of age.

```{r cliff_map_age_30, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
cliff_map("Couple", 30, 0)
```

```{r cliff_map_age_40, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
cliff_map("Couple", 40, 0)
```

```{r cliff_map_age_50, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
cliff_map("Couple", 50, 0)
```

```{r cliff_map_age_60, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
cliff_map("Couple", 60, 0)
```

### Summary

The Affordable Care Act requires insurers to offer insurance to everyone on the same terms, meaning they cannot disriminate based on pre-existing conditions. To avoid adverse selection, almost everyone is required to have a certain level of health insurance coverage or pay a penalty. Subsidies are provided to make the required coverage affordable. These subsidies are based on household income and phase out as income rises. However, no subsidy is available if household income exceeds 400% of the federal poverty level (FPL), and any subsidy received must be repaid. High premiums translate directly into high subsidies, which in turn translate into a high "cliff" at 400% of FPL.

The size of the cliff varies with age and geographically, and can easily be tens of thousands of dollars for older households. Households that are affected therefore stand to lose tens of thousands of dollars if their income exceeds 400% of FPL, which amounts to a marginal income tax rate in excess of 100% and creates a substantial disincentive to work.

<br/>

Data sources:

* Health insurance plans and premiums from [HealthCare.gov](https://www.healthcare.gov/health-and-dental-plan-datasets-for-researchers-and-issuers/).
* Federal Poverty Levels from [U.S. Department of Health and Human Services](https://aspe.hhs.gov/poverty-guidelines).
* Applicable Percentage tables from [Internal Revenue Service](https://www.irs.gov/). PDFs of the Revenue Procedures are included in the source code repository.

Source code: [https://github.com/davidbody/aca-subsidies](https://github.com/davidbody/aca-subsidies)

Author: [David W. Body](https://twitter.com/david_body)

---
